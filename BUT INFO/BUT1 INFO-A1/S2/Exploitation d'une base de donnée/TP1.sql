SELECT co.nom_commune, co.code_insee, op.nomfo, op.generation, op.technologie
    FROM basetd.Commune co, basetd.departement de, basetd.operateur op, basetd.distribution di
    WHERE op.numfo=di.numfo
        and co.code_Insee=di.code_insee
        and co.nomdep=de.nomdep
        and co.nom_commune='Nantes';
    
SELECT co.nom_commune, co.code_insee, op.nomfo, op.generation, op.technologie
    FROM basetd.Commune co, basetd.departement de, basetd.operateur op, basetd.distribution di
    WHERE op.numfo=di.numfo
        and co.code_Insee=di.code_insee
        and co.nomdep=de.nomdep
        and co.nom_commune='Nantes'
        and op.generation='5G';
        
        
SELECT di.adresse,op.nomfo
    FROM basetd.Commune co, basetd.departement de, basetd.operateur op, basetd.distribution di
    WHERE op.numfo=di.numfo
        and co.code_Insee=di.code_insee
        and co.nomdep=de.nomdep
        and co.nom_commune='Nantes'
        and op.generation='5G'
        and op.technologie='5G NR 3500'
        ORDER BY di.adresse;
        
SELECT co.nom_commune,op.nomfo, count(op.generation)
    FROM basetd.Commune co, basetd.departement de, basetd.operateur op, basetd.distribution di
    WHERE op.numfo=di.numfo
        and co.code_Insee=di.code_insee
        and co.nomdep=de.nomdep
        and op.generation='5G'
GROUP BY co.nom_commune, op.nomfo order by 3 desc;


SELECT co.nom_commune,op.nomfo, count(op.generation)
    FROM basetd.Commune co, basetd.departement de, basetd.operateur op, basetd.distribution di
    WHERE op.numfo=di.numfo
        and co.code_Insee=di.code_insee
        and co.nomdep=de.nomdep
        and op.generation='5G'
GROUP BY co.nom_commune, op.nomfo order by 3 desc, 1 FETCH NEXT 10 ROWS ONLY;


SELECT co.nom_commune,op.nomfo, count(op.generation)
    FROM basetd.Commune co, basetd.departement de, basetd.operateur op, basetd.distribution di
    WHERE op.numfo=di.numfo
        and co.code_Insee=di.code_insee
        and co.nomdep=de.nomdep
        and op.generation='5G'
having count(op.generation)>50 group by co.nom_commune order by 2 desc;

SELECT co.nomdep, count(op.generation)
    FROM basetd.Commune co, basetd.departement de, basetd.operateur op, basetd.distribution di
    WHERE op.numfo=di.numfo
        and co.code_Insee=di.code_insee
        and co.nomdep=de.nomdep
        and op.generation='4G'
        group by de.nomdep;