select distinct co.nom_commune
    from basetd.Commune co,basetd.departement de
    where co.nomdep = de.nomdep
    and de.code_departement = '49';
    
select distinct co.nom_commune
    from basetd.commune co
    where co.nomdep in (select de.nomdep from basetd.departement de
    where de.code_departement = '49');
    
select distinct co.nom_commune
    from basetd.commune co
    where exists (select * from basetd.departement de
    where de.code_departement = '49'
    and co.nomdep=de.nomdep);
    
/*2*/

Select distinct co.nom_commune, co.nomdep
    from basetd.Commune co, basetd.operateur op
    where op.generation='5G' and (co.code_insee, op.numfo) in (select di.code_insee, di.numfo from basetd.distribution di);
    
Select distinct co.nom_commune, co.nomdep
    from basetd.commune co
    where code_insee in (select distinct code_insee from basetd.distribution di, basetd.operateur op where op.numfo = di.numfo and op.generation='5G');

Select distinct co.nom_commune, co.nomdep
    from basetd.commune co
    where exists (select * from basetd.distribution di, basetd.operateur op where op.numfo=di.numfo and co.code_insee=di.code_insee and op.generation='5G');
    
/*3*/

Select distinct co.nom_commune, co.nomdep
    from basetd.commune co
    where code_insee not in (select distinct code_insee from basetd.distribution di, basetd.operateur op where op.numfo = di.numfo and op.generation='5G');

Select distinct co.nom_commune, co.nomdep
    from basetd.commune co
    where not exists (select * from basetd.distribution di, basetd.operateur op where op.numfo=di.numfo and co.code_insee=di.code_insee and op.generation='5G');
    
/*4*/

Select distinct co.nom_commune, co.nomdep
    from basetd.commune co, basetd.departement de
    where code_insee not in (select distinct code_insee from basetd.distribution di, basetd.operateur op where op.numfo = di.numfo and op.generation='5G') 
    and co.nomdep = de.nomdep
    and de.code_departement = '44';

Select distinct co.nom_commune, co.nomdep
    from basetd.commune co, basetd.departement de
    where not exists (select * from basetd.distribution di, basetd.operateur op where op.numfo=di.numfo and co.code_insee=di.code_insee and op.generation='5G')
    and co.nomdep = de.nomdep
    and de.code_departement = '44';
    
/*5*/

select distinct co.nomdep, count(co.nom_commune)
    from basetd.commune co, basetd.departement de
    where  co.nomdep = de.nomdep
    group by co.nomdep;
    
select distinct de.nomdep, (select count(co.nom_commune) from basetd.commune co where co.nomdep = de.nomdep)
    from basetd.departement de;
    
/*6*/

Select distinct co.nom_commune, count(co.code_insee) nb_ant
    from basetd.Commune co, basetd.operateur op, basetd.departement de, basetd.distribution di
    where co.nomdep = de.nomdep 
    and co.nomdep='Loire-Atlantique'
    and op.numfo=di.numfo
    and op.generation='5G'
    and co.code_insee = di.code_insee
    group by co.nom_commune
    order by 2 desc;
    
select distinct co.nom_commune, (select count(co.code_insee)
    from basetd.operateur op, basetd.distribution di
    where op.numfo=di.numfo
    and op.generation='5G'
    and co.code_insee = di.code_insee) nb_ant
    from basetd.commune co, basetd.departement de
    where co.nomdep = de.nomdep 
    and de.code_departement='44'
    order by 2 desc;

/*7*/

Select distinct co.nom_commune, count(co.code_insee) nb_ant
    from basetd.Commune co, basetd.operateur op, basetd.departement de, basetd.distribution di
    where co.nomdep = de.nomdep 
    and co.nomdep='Loire-Atlantique'
    and op.numfo=di.numfo
    and op.generation='5G'
    and co.code_insee = di.code_insee
    group by co.nom_commune
    having count(*) >= 10
    order by 2 desc;
    
select distinct co.nom_commune, (select count(co.code_insee)
    from basetd.operateur op, basetd.distribution di
    where op.numfo=di.numfo
    and op.generation='5G'
    and co.code_insee = di.code_insee
    having count(*) >= 10) nb_ant
    from basetd.commune co, basetd.departement de
    where co.nomdep = de.nomdep 
    and de.code_departement='44'
    order by 2 desc;

/*8*/

Select co.nom_commune,(select count(*) from basetd.operateur op, basetd.distribution di
    where di.code_insee=co.code_insee
    and op.generation='5G'
    and op.numfo=di.numfo) nb_5G,
    
    (select count(*) from basetd.operateur op, basetd.distribution di
    where di.code_insee=co.code_insee
    and op.generation='4G'
    and op.numfo=di.numfo) nb_4G
    from basetd.commune co
    where co.nomdep='Loire-Atlantique'
    order by 2 desc;

/*9*/

select op.nomfo,op.technologie,(select count(*)
    from basetd.distribution di
    where di.numfo=op.numfo) nombre
    from basetd.operateur op
    where (op.technologie='5G NR 3500'
    or op.technologie='5G NR 2100'
    or op.technologie='5G NR 700')
    order by 1;
    
/*10*/

select distinct op.nomfo,op.technologie,(select count(*)
    from basetd.distribution di, basetd.commune co
    where di.numfo=op.numfo
    and co.nom_commune='Nantes'
    and co.code_insee=di.code_insee) nombre
    from basetd.operateur op, basetd.commune co
    where (op.technologie='5G NR 3500'
    or op.technologie='5G NR 2100'
    or op.technologie='5G NR 700')
    order by 1;
    

/*11*/

select distinct op.nomfo,op.technologie,(select count(*)
    from basetd.distribution di, basetd.commune co
    where di.numfo=op.numfo
    and co.nomdep='Loire-Atlantique'
    and co.code_insee=di.code_insee) nombre
    from basetd.operateur op, basetd.commune co
    where (op.technologie='5G NR 3500'
    or op.technologie='5G NR 2100'
    or op.technologie='5G NR 700')
    order by 1;

/*12*/

select co.nom_commune
    from basetd.commune co
    where code_insee not in (select co.code_insee
        from basetd.operateur op
        where op.numfo not in (select op.numfo
        from basetd.distribution di
        where co.code_insee=di.code_insee
        and op.numfo =di.numfo))
    group by co.nom_commune;
    
select co.nom_commune
    from basetd.commune co
    where not exists (select co.code_insee
        from basetd.operateur op
        where not exists (select op.numfo
        from basetd.distribution di
        where co.code_insee=di.code_insee
        and op.numfo=di.numfo)
        and code_insee=co.code_insee)
    group by co.nom_commune;

/*13*/

select co.nom_commune
    from basetd.commune co
    where code_insee not in (select co.code_insee
        from basetd.operateur op
        where op.numfo not in (select op.numfo
        from basetd.distribution di
        where co.code_insee=di.code_insee
        and op.numfo =di.numfo)
        and op.generation='5G')
    group by co.nom_commune;

/*14*/

select co.nom_commune
    from basetd.commune co
    where code_insee not in (select co.code_insee
        from basetd.operateur op
        where op.numfo not in (select op.numfo
        from basetd.distribution di
        where co.code_insee=di.code_insee
        and op.numfo =di.numfo)
        and op.generation='4G'
        and op.nomfo='ORANGE')
    group by co.nom_commune;